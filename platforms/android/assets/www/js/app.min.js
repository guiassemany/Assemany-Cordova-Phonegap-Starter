'use strict';

var acs = angular.module('AssemanyCordovaStarter', [
      'ngTouch',
      'ngRoute',
      'ngAnimate',
      'ngCordova',
      'ngResource',
      'ngMaterial',
      'ngMdIcons',
      'pascalprecht.translate'
]);

    angular.module('AssemanyCordovaStarter')
    .config(['$routeProvider', '$locationProvider',
      function($routeProvider, $locationProvider) {
        $routeProvider
          .when('/dashboard', {
            templateUrl: 'webapp/views/dashboard.html',
            controller: 'DashboardCtrl',
            controllerAs: 'dashboard'
          })
          .when('/tabs', {
            templateUrl: 'webapp/views/tabs.html',
            controller: 'TabsCtrl',
            controllerAs: 'tabs'
          })
          .when('/api', {
            templateUrl: 'webapp/views/api-consume.html',
            controller: 'ApiConsumeCtrl',
            controllerAs: 'apicons'
          })
          .when('/dialogs', {
            templateUrl: 'webapp/views/dialogs.html',
            controller: 'dialogsCtrl',
            controllerAs: 'dialogs'
          })
          .when('/cards', {
            templateUrl: 'webapp/views/cards.html',
            controller: 'CardsCtrl',
            controllerAs: 'cards'
          })
          .when('/plugin/camera', {
            templateUrl: 'webapp/views/plugins/picture.html',
            controller: 'PictureCtrl',
            controllerAs: 'picture'
          })
          .when('/plugin/deviceInfo', {
            templateUrl: 'webapp/views/plugins/deviceInfo.html',
            controller: 'DeviceInfoCtrl',
            controllerAs: 'device'
          })
          .when('/auth/login', {
            templateUrl: 'webapp/views/auth/login.html',
            controller: 'LoginCtrl',
            controllerAs: 'login'
          });


        $routeProvider.otherwise({redirectTo: '/tabs'});
        //$locationProvider.html5Mode(true);

    }])
    .config(["$mdThemingProvider", function($mdThemingProvider) {
      $mdThemingProvider.theme('default')
        .primaryPalette('teal')
        .accentPalette('deep-orange');
    }])
    .config(["$compileProvider", function ($compileProvider){
        $compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|http|ftp|mailto|file|tel):/);
    }])
    .config(["$translateProvider", function($translateProvider) {

      $translateProvider.preferredLanguage('en');
      $translateProvider.useSanitizeValueStrategy('escape');
      $translateProvider.useStaticFilesLoader({
        prefix: 'webapp/languages/',
        suffix: '.json'
      });

    }]);

acs.controller('ApiConsumeCtrl', ["Post", function(Post) {

  var vm = this;

  //$scope.posts = [];

  vm.posts = [];
  Post.query(function(data) {
    vm.posts = data;
  });
  //console.log($scope.posts);

}]);

acs.controller('AppCtrl', ['$scope', '$mdSidenav', '$timeout','$log', '$location', '$translate', '$filter',  function($scope, $mdSidenav, $timeout, $log, $location, $translate, $filter) {
            var itensMenu = [
              {
                  nome: 'DASHBOARD',
                  icone: 'dashboard',
                  //iconeCor: 'pink',
                  view: '/dashboard'
              },
              {
                  nome: 'TABS',
                  icone: 'tab',
                  //iconeCor: 'red',
                  view: 'tabs'
              },
              {
                  nome: 'RESTFULL_TEST',
                  icone: 'sync',
                  //iconeCor: 'pink',
                  view: 'api'
              },
              {
                  nome: 'DIALOGS',
                  icone: 'chat',
                  //iconeCor: 'pink',
                  view: 'dialogs'
              },
              {
                  nome: 'CARDS',
                  icone: 'view_stream',
                  //iconeCor: 'pink',
                  view: '/cards'
              },
              {
                  nome: 'CAMERA',
                  icone: 'camera',
                  //iconeCor: 'pink',
                  view: '/plugin/camera'
              },
              {
                  nome: 'DEVICE_INFO',
                  icone: 'perm_device_info',
                  //iconeCor: 'pink',
                  view: '/plugin/deviceInfo'
              }
            ];

            $scope.selected = null;
            $scope.itensMenu = itensMenu;
            $scope.selecionaItem = selecionaItem;
            $scope.habilitaMenu = habilitaMenu;
            $scope.changeLanguage = changeLanguage;

            function habilitaMenu(name) {
              $mdSidenav(name).toggle();
            }

            function selecionaItem(itemView) {
              $scope.selected = angular.isNumber(itemView) ? $scope.itensMenu[itemView.index] : itemView;
              $location.path(itemView);
              hideToolbar(itemView);
              $scope.habilitaMenu('left');
            }

            function changeLanguage(langKey) {
              $translate.use(langKey);
            };

        }]);

acs.controller('CardsCtrl', [ '$scope', '$mdDialog', function($scope, $mdDialog) {

  $scope.allCards = [
    {
      "title": "Fiscolas",
      "text": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus malesuada aliquam ante, sit amet commodo mi iaculis et. Morbi sed lectus lectus."
    },
    {
      "title": "Fiscolandia",
      "text": "Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros."
    },
    {
      "title": "FiscoNunes",
      "text": "Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros."
    },
    {
      "title": "Fiscolangelo",
      "text": "Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros."
    }
  ];

  var originatorEv;

    $scope.openMenu = function($mdOpenMenu, ev) {
      originatorEv = ev;
      $mdOpenMenu(ev);
    };

    $scope.addCard = function(card){
        $scope.allCards.push(card);
        $scope.newCard = null;
      }

    $scope.edit = function() {
      $mdDialog.show(
        $mdDialog.alert()
          .targetEvent(originatorEv)
          .clickOutsideToClose(true)
          .parent('body')
          .title('You clicked the edit button!')
          .content('Thats just an example of how easy it is to define actions on ng-click.')
          .ok('Awesome!')
      );

      originatorEv = null;
    };

    $scope.delete = function(card){
      var index = $scope.allCards.indexOf(card);
      $scope.allCards.splice(index, 1);
    };

  //console.log($scope.allCards);

}]);

acs.controller('DashboardCtrl', ["$scope", "$mdSidenav", "$mdUtil", function ($scope,$mdSidenav,$mdUtil) {

}]);

acs.controller('DeviceInfoCtrl', [ '$scope', '$cordovaDevice', function($scope, $cordovaDevice) {
  
  document.addEventListener("deviceready", function () {

     $scope.device = $cordovaDevice.getDevice();
     $scope.cordova = $cordovaDevice.getCordova();
     $scope.model = $cordovaDevice.getModel();
     $scope.platform = $cordovaDevice.getPlatform();
     $scope.uuid = $cordovaDevice.getUUID();
     $scope.version = $cordovaDevice.getVersion();

  }, false);

}]);

acs.controller('PictureCtrl', [ '$scope', '$cordovaCamera', function($scope, $cordovaCamera) {

  $scope.takePicture = function() {
    var options = {
      quality: 100,
      destinationType: Camera.DestinationType.FILE_URI,
      sourceType: Camera.PictureSourceType.CAMERA,
      allowEdit: false,
      encodingType: Camera.EncodingType.JPEG,
      //targetWidth: 300,
      //targetHeight: 300,
      popoverOptions: CameraPopoverOptions,
      saveToPhotoAlbum: false
    };

    $cordovaCamera.getPicture(options).then(function(imageData) {
      var image = document.getElementById('myImage');
      image.src = imageData;
    }, function(err) {
      // error
    });
  }

  $scope.cleanPicture = function() {
    var image = document.getElementById('myImage');
    image.src = 'img/no-picture.png';
  }

}]);

acs.controller('TabsCtrl', ["$scope", "$mdSidenav", "$mdUtil", function ($scope,$mdSidenav,$mdUtil) {

}]);

acs.controller('dialogsCtrl', ['$scope', '$mdDialog', '$filter', function($scope, $mdDialog, $filter) {
  $scope.status = '  ';
  $scope.showAlert = function(ev) {
    // Appending dialog to document.body to cover sidenav in docs app
    // Modal dialogs should fully cover application
    // to prevent interaction outside of dialog
    $mdDialog.show(
      $mdDialog.alert()
        .parent(angular.element(document.querySelector('#popupContainer')))
        .clickOutsideToClose(true)
        .title($filter('translate')('MESSAGE'))
        .content('Texto do alerta aqui.')
        .ariaLabel('Demonstração de alerta')
        .ok('Entendi!')
        .targetEvent(ev)
    );
  };
  $scope.showConfirm = function(ev) {
    // Appending dialog to document.body to cover sidenav in docs app
    var confirm = $mdDialog.confirm()
          .title($filter('translate')('MESSAGE'))
          .content('Escolha uma das opções.')
          .ariaLabel('Teste')
          .ok('Sim!')
          .cancel('Não')
          .targetEvent(ev);
    $mdDialog.show(confirm).then(function() {
      $scope.status = 'Você clicou em sim.';
    }, function() {
      $scope.status = 'Você clicou em não.';
    });
  };
}]);

acs.factory("Post", ["$resource", function($resource) {
  return $resource("http://jsonplaceholder.typicode.com/posts");

}]);

acs.service("testeService",["$q","$http", function ($q,$http) {



}]);

acs.controller('LoginCtrl', ['$scope', '$filter', function ($scope,$filter) {
  
}]);
